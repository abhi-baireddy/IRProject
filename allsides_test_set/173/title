Federal appeals court rules against Trump in two major immigration cases